# 2.2.2 Cycle 2

## Design

This cycle is meant to focus on the beginnings of the algorithm I will be using to pick and trade shares. I will use an API called Alpaca API. This will give me access to a paper trading system (not using real life shares). This code needs to be able to fetch my account information from Alpaca.

## Objectives

* [x] Begin foundation of the Alpaca API
* [x] Fetch the price of specific shares

## Usability features

This part of the program is not seen by the user. However I have taken steps to ensure that its easier for me to follow the code whilst I'm writing it. To do this I have added ample spacing between each line and comments to remind me of what each part does.

## Key Variables

The key variables in the code are:

&#x20;`API_KEY`,&#x20;

`SECRET_KEY`,&#x20;

`stock_client`,&#x20;

`multisymbol_request_params`,&#x20;

`latest_multisymbol_qoutes`,&#x20;

`gld_latest_ask_price`,&#x20;

`spy_latest_ask_price`,

`tlt_latest_ask_price`.

`API_KEY` and `SECRET_KEY` are used to authenticate the user with the Alpaca API. `stock_client` is an instance of the `StockHistoricalDataClient` class, which is used to retrieve historical data for stocks.&#x20;

`multisymbol_request_params` is an instance of the `StockLatestQuoteRequest` class, which is used to request the latest quotes for multiple symbols.&#x20;

`latest_multisymbol_qoutes` is a dictionary containing the latest quotes for the requested symbols.&#x20;

`gld_latest_ask_price`, `spy_latest_ask_price`, and `tlt_latest_ask_price` are variables that store the latest ask prices for the GLD, SPY, and TLT symbols respectively.

## Pseudocode

```
Import StockHistoricalDataClient and StockLatestQuoteRequest from alpaca.data

Set API_KEY to "PKBFRFWBV2IIXYC9BPQ5"
Set SECRET_KEY to "9rZHrcqHyVAqh6TrljCTayCfghqTmY9HRpkBK7uE"

Create a new instance of StockHistoricalDataClient with API_KEY and SECRET_KEY as arguments and assign it to stock_client

Create a new instance of StockLatestQuoteRequest with ["SPY", "GLD", "TLT"] as the argument for symbol_or_symbols and assign it to multisymbol_request_params

Call the get_stock_latest_quote method of stock_client with multisymbol_request_params as the argument and assign the result to latest_multisymbol_qoutes

Get the ask_price of "GLD" from latest_multisymbol_qoutes and assign it to gld_latest_ask_price
Get the ask_price of "SPY" from latest_multisymbol_qoutes and assign it to spy_latest_ask_price
Get the ask_price of "TLT" from latest_multisymbol_qoutes and assign it to tlt_latest_ask_price

Print "The current price of TLT is " + tlt_latest_ask_price
Print "The current price of SPY is " + spy_latest_ask_price
Print "The current price of GLD is " + gld_latest_ask_price
```

## Development

### Outcome

In this cycle I successfully managed to retrieve my account information from Alpaca. I did this by using node \<file name> in the terminal

```javascript
//fetching the alpaca API
const Alpaca = require('@alpacahq/alpaca-trade-api')

//keys for project
const APIKey = "PKQU3UMD89C6VSJGZRAV"
const APISecret = "IsaGQPd9bhv4nH5ahSJO4MvSNKPKXiG2RHZpAbyK"

//using object to store necessary data
const alpaca = new Alpaca({
    keyId: APIKey,
    secretKey: APISecret,
    paper: true
  });

//using an asynchronis function to call the data from my alpaca account
async function printAccount() {
    const account = await alpaca.getAccount();
    console.log(account);
}

printAccount();
```

## Challenges

The main challenge I was experiencing was with the type of modules I was importing from Alpaca. The Alpaca API used common JS modules whereas I was inintally using the ES module import. I had to change this to a different format and it then worked. In addition to this understanding the documentation for the API poses its own challenge.

## Testing

### Tests

| Test | Instructions                  | What I expect                                       | What actually happens            | Pass/fail |
| ---- | ----------------------------- | --------------------------------------------------- | -------------------------------- | --------- |
| 1    | Run index.js file in terminal | My account data should be displayed                 | As expected                      | Pass      |
| 2    | Open html file in browser     | Account data should be displayed in browser console | Data is not displayed in console | Fail      |

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption><p>Terminal screenshot</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption><p>Screenshot of browser console</p></figcaption></figure>
